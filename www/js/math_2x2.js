
function finish(){
	var limitEntalpy1=-50.24;
var limitEntalpy2=9196.160;

	var resultvalue=document.getElementById("out1");
	var input1=document.getElementById("formula1").value;		
	var input2=document.getElementById("formula2").value;			
		 var tvout=document.getElementById("in1").value;		var a=document.getElementById("in1");	
		 var fiout=document.getElementById("in2").value;		var aa=document.getElementById("in2");
			var b=document.getElementById("error1");
			var c=document.getElementById("error2");
		 var P=parseFloat(document.getElementById("Davlenie").value);	
var result1=document.getElementById("result1");
  var result2=document.getElementById("result2");
  
  var fiin,tvin,Hin;
  var inputType1=document.getElementById("outtemp1");
  var inputType2=document.getElementById("outtemp2");
  
		 var velicina1="";
		 var velicina2="";
if(tvout==""){b.value="Введите число!"; 
			document.getElementById("outtemp1").value="";
			document.getElementById("outtemp2").value="";
			document.getElementById("result1").value="";
			document.getElementById("result2").value="";
return false;}	
if(tvout!=""){b.value="";}


else{
	tvout=parseFloat(document.getElementById("in1").value);		var a=parseFloat(document.getElementById("in1"));
	fiout=parseFloat(document.getElementById("in2").value);		var aa=parseFloat(document.getElementById("in2"));

	}	
if(fiout==""){
			document.getElementById("outtemp1").value="";
			document.getElementById("outtemp2").value="";
			document.getElementById("result1").value="";
			document.getElementById("result2").value="";	
	c.value="Введите число!"; 
return false;}	
if(fiout!=""){c.value="";}
//////////////////////////////////////////////////////////////////проверяем первон поле 
	
		 if(input1=="-Выберите величину-")
		 {
			 document.getElementById('notselect1').innerHTML="Выберите величину!";
			 
		 }
		 else if(input1=="Отн. влажность")
		 {	
	 velicina1=2;
	 document.getElementById('notselect1').innerHTML="";
			 
			 fiin=tvout/100;
			 if(tvout>100)
			 {	fiin=0;
				
				 tvout=100;
				 a.value=tvout; 	b.value=tvout;
				 tvout=tvout/100;
				 fiin=tvout;
				 
				 }
			 else if(tvout<=0.1&&tvout>0)
			 {	fiin=0;
				 tvout=0.1;
				 a.value=tvout;		b.value=tvout;
				 tvout=tvout/100;
				 fiin=tvout;
				 
				 }
			 else if(tvout<0&&tvout>-100)
			 {	fiin=0;
				 tvout=tvout*-1;
				  a.value=tvout;		b.value=tvout;
				 tvout=tvout/100;
				 fiin=tvout;
				
				 }
				  else if(tvout<-100)
				 {
					 fiin=0;
				 tvout=100;
				 a.value=tvout;	b.value=tvout;
				 tvout=tvout/100;
				 fiin=tvout;
				 
				 }
		 }
		 else if(input1=="Энтальпия")
		 {
	 velicina1=3;
	 Hin=tvout;
	 document.getElementById('notselect1').innerHTML="";
			if(tvout<-50.299)
			{
				tvout=-50.299;
				Hin=tvout;
				 a.value=tvout;		b.value=tvout;
			}
			else if(tvout>9196.160)
			{
				tvout=9196.160;
				Hin=tvout;
				 a.value=tvout;		b.value=tvout;
			}
		 }
		 else if(input1=="Температура")	
		 {tvin=0;
		velicina1=1;	
		document.getElementById('notselect1').innerHTML="";
		tvin=tvout;
			 if(tvout<-50)
				{tvin=0; 
			var number=-50;
				  tvout=number;
				  tvin=tvout;
				 a.value=tvout;		b.value=tvout;
				}
			 else if(tvout>95)
				 {tvin=0;
					 tvout=95;
					 tvin=tvout;
					 a.value=tvout;		b.value=tvout;
				 }
		 }
////////////////////////////////////////////////////////проверяем второе поле 
		if(input2=="-Выберите величину-")
		 {
			 document.getElementById('notselect2').innerHTML="Выберите величину!";
			 
		 }	
		 else if(input2=="Отн. влажность")
		 {fiin=0;
		velicina2=2;
		document.getElementById('notselect2').innerHTML="";
			 
			 fiin=fiout/100;
			 if(fiout>100)
			 {	fiin=0;
				 fiout=100;
				 aa.value=fiout;	c.value=fiout;
				 fiout=fiout/100;
				 fiin=fiout;
				 
				 }
			 else if(fiout<=0.1&&fiout>0)
			 {	fiin=0;
				 fiout=0.1;
				 aa.value=fiout;	c.value=fiout;
				 fiout=fiout/100;
				 fiin=fiout;
				 
				 }
			 else if(fiout<0&&fiout>-100)
			 {	fiin=0;
				 fiout=fiout*-1;
				 aa.value=fiout;	c.value=fiout;
				 fiout=fiout/100;
				 fiin=fiout;
				 
				 }
				 else if(fiout<-100)
				 {
					 fiin=0;
				 fiout=100;
				 aa.value=fiout;	c.value=fiout;
				 fiout=fiout/100;
				 fiin=fiout;
				 
				 }
		 }
		 else if(input2=="Энтальпия")
		 {
		velicina2=3;
		Hin=fiout;
		document.getElementById('notselect2').innerHTML="";
			if(fiout<-50.299)/////////////////////////////////////////////////////////////////////////////////////////////////////////////заменить
			{
				fiout=-50.299;/////////////////////////////////////////////////////////////////////////////////////////////////////////////заменить
				Hin=fiout;
				 aa.value=fiout;	c.value=fiout;
			}
			else if(fiout>9196.160)/////////////////////////////////////////////////////////////////////////////////////////////////////////////заменить
			{
				fiout=9196.160;/////////////////////////////////////////////////////////////////////////////////////////////////////////////заменить
				Hin=fiout;
				 aa.value=fiout;	c.value=fiout;
			}
		 }
		 else if(input2=="Температура")
		 {tvin=0;
		velicina2=1;
		tvin=fiout;
		document.getElementById('notselect2').innerHTML="";
			 if(fiout<-50)
				{ tvin=0;
			var number=-50;
				  fiout=number;
				  tvin=fiout;
				 aa.value=fiout;	c.value=fiout;
				}
			 else if(fiout>95)
				 {tvin=0;
					 fiout=95;
					 tvin=fiout;
					aa.value=fiout;		c.value=fiout;
				 }
		 }
	if(input1==input2)
	{
			document.getElementById("outtemp1").value="";
			document.getElementById("outtemp2").value="";
			document.getElementById("result1").value="";
			document.getElementById("result2").value="";
							
									return resultvalue.value="ошибка: входные величины совпадают";
	}
	else if(tvout==""||fiout=="")
	{
		if(tvout==""){
			 
			document.getElementById("outtemp1").value="";
			document.getElementById("outtemp2").value="";
			document.getElementById("result1").value="";
			document.getElementById("result2").value="";
		return b.value="Введите число!";
		}	
		if(tvout!=""){
			b.value="";
			}
		if(fiout==""){
			
			document.getElementById("outtemp1").value="";
			document.getElementById("outtemp2").value="";
			document.getElementById("result1").value="";
			document.getElementById("result2").value="";
		return c.value="Введите число!"; 
		}	
		if(fiout!=""){c.value="";}
	}
else{
	var metod;
	if((velicina1==1&&velicina2==2)||(velicina1==2&&velicina2==1))// темп и отн влажность  //  отн влажность и темп
	{
		metod=1;
		}
	if((velicina1==1&&velicina2==3)||(velicina1==3&&velicina2==1))//энтальпия и темп  // темп и энтальпия
	{
		metod=2;
		}
	if((velicina1==2&&velicina2==3)||(velicina1==3&&velicina2==2))//относ.влажность и энтальпия///энтальпия и относ.влажность     +
	{
		metod=3;
		}
		
		
		resultvalue.value="";
var t=[-50.0,-49.0,-48.0,-47.0,-46.0,-45.0,-44.0,-43.0,-42.0,-41.0,-40.0,-39.0,-38.0,-37.0,-36.0,-35.0,-34.0,-33.0,-32.0,-31.0,-30.0,-29.0,-28.0,-27.0,-26.0,-25.0,-24.0,-23.0,-22.0,-21.0,-20.0,-19.0,-18.0,-17.0,-16.0,-15.0,-14.0,-13.0,-12.0,-11.0,-10.0,-9.0,-8.0,-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0];
var d=[0.00002405,0.00002737,0.00003068,0.00003483,0.00003898,0.00004313,0.00004810,0.00005474,0.00006137,0.00006884,0.00007713,0.00008709,0.00009870,0.00011110,0.00012440,0.00013850,0.00015350,0.00017000,0.00018830,0.00020900,0.00023230,0.00025800,0.00028620,0.00031780,0.00035100,0.00039080,0.00043240,0.00047800,0.00052790,0.00058180,0.00064080,0.00070570,0.00077630,0.00085280,0.00093680,0.00102800,0.00112700,0.00123500,0.00135200,0.00148000,0.00161800,0.00176700,0.00193100,0.00210700,0.00229800,0.00250400,0.00272900,0.00297100,0.00323300,0.00351600,0.00382300,0.00411100,0.00441900,0.00474800,0.00509800,0.00547000,0.00586800,0.00629000,0.00674100,0.00721900,0.00772700,0.00826800,0.00884100,0.00945100,0.01009700,0.01078300,0.01151100,0.01228200,0.01310000,0.01396600,0.01488300,0.01585400,0.01688200,0.01797000,0.01912100,0.02033800,0.02162600,0.02298700,0.02442500,0.02594600,0.02755200,0.02925000,0.03104300,0.03293700,0.03493700,0.03705000,0.03928100,0.04163700,0.04412400,0.04675000,0.04952400,0.05245400,0.05554700,0.05881600,0.06226700,0.06591400,0.06976800,0.07384300,0.07814300,0.08269600,0.08751900,0.09261400,0.09800700,0.10372000,0.10977300,0.11619100,0.12299900,0.13022500,0.13789000,0.14604300,0.15471400,0.16393900,0.17377300,0.18426300,0.19545300,0.20742200,0.22022500,0.23394800,0.24867300,0.26450700,0.28155800,0.29993200,0.31981100,0.34134000,0.36472200,0.39017200,0.41796000,0.44838400,0.48181500,0.51871900,0.55958800,0.60506600,0.65594200,0.71319400,0.77801800,0.85203800,0.91717100,1.03613600,1.15245600,1.29102200,1.45882400,1.66594000,1.92791000,2.26941000,2.73291000,3.39739000];
var h=[-50240.0,-49230.0,-48210.0,-47200.0,-46180.0,-45170.0,-44150.0,-43130.0,-42100.0,-41080.0,-40050.0,-39020.0,-37990.0,-36950.0,-35910.0,-34870.0,-33830.0,-32780.0,-31730.0,-30680.0,-29610.0,-28540.0,-27470.0,-26380.0,-25310.0,-24190.0,-23080.0,-21960.0,-20830.0,-19690.0,-18540.0,-17370.0,-16190.0,-15000.0,-13780.0,-12550.0,-11300.0,-10020.0,-8720.0,-7400.0,-6040.0,-4660.0,-3250.0,-1800.0,-310.0,1210.0,2780.0,4400.0,6060.0,7780.0,9560.0,11300.0,13080.0,14920.0,16810.0,18760.0,20780.0,22860.0,25010.0,27230.0,29530.0,31910.0,34380.0,36950.0,39600.0,42360.0,45230.0,48210.0,51310.0,54540.0,57900.0,61400.0,65050.0,68860.0,72830.0,76970.0,81300.0,85820.0,90540.0,95480.0,100640.0,106040.0,111690.0,117610.0,123810.0,130310.0,137110.0,144250.0,151730.0,159580.0,167820.0,176470.0,185560.0,195110.0,205140.0,215690.0,226790.0,238480.0,250760.0,263720.0,277400.0,291790.0,306990.0,323030.0,339990.0,357900.0,376870.0,396950.0,418200.0,440760.0,464700.0,490120.0,517170.0,545980.0,576660.0,609420.0,644410.0,681880.0,722020.0,765140.0,811520.0,861450.0,915420.0,973810.0,1037160.0,1106080.0,1179350.0,1263620.0,1353870.0,1453520.0,1563830.0,1686510.0,1823690.0,1978010.0,2152650.0,2352010.0,2581220.0,2847600.0,3160600.0,3533380.0,3984720.0,4541690.0,5246090.0,6154180.0,7410130.0,9196160.0];
var x_spl, y_spl, b_spl, c_spl, d_spl, bhft, chft, dhft, bhfd, chfd, dhfd, bdft, cdft, ddft, bdfh, cdfh, ddfh, btfh, ctfh, dtfh, btfd, ctfd, dtfd;
var d1, h1, dout, hout;
		 
		 
///**********   spline(146,t,h,bhft,chft,dhft) ;   ***********
    					x_spl = t;
                        y_spl = h; 
	bhft = [996.79514944,1019.8715172,1013.7187816,1015.2533562,1015.2677936,1013.6754693,1020.0303292,1026.2032139,1025.1568152,1023.1695253,1032.1650835,1028.1701405,1035.1543543,1041.2124423,1039.9958764,1038.8040521,1044.7879151,1052.0442874,1047.0349353,1059.8159714,1073.7011793,1065.3793115,1084.7815746,1075.4943902,1093.2408646,1121.5421516,1110.5905292,1126.0957316,1135.0265446,1143.7980902,1159.7810947,1177.0775309,1181.9087818,1205.2873421,1226.9418499,1236.9452582,1265.2771172,1291.9462731,1306.9377903,1340.3025657,1371.8519468,1392.2896469,1428.9894654,1471.7524914,1504.000569,1542.2452327,1597.0185003,1639.680766,1684.2584356,1763.2854916,1762.5995978,1746.316117,1812.1359342,1865.140146,1917.3034816,1985.6459276,2050.1128079,2113.9028406,2184.2758296,2258.9938411,2339.7488062,2422.0109343,2522.2074567,2609.1592389,2701.1555877,2816.2184102,2923.9707714,3037.898504,3164.4352124,3294.3606465,3428.1222018,3573.1505465,3729.2756123,3889.7470042,4051.7363707,4233.307513,4425.0335773,4616.5581779,4828.733711,5048.5069782,5277.2383763,5522.5395167,5782.6035568,6057.0462562,6349.2114185,6646.1080697,6966.3563026,7308.4667199,7659.7768178,8042.4260088,8440.5191471,8865.4974029,9317.4912415,9784.5376312,10284.358234,10818.029433,11393.524033,11977.874436,12604.978225,13322.212665,14026.171116,14783.102873,15611.417394,16491.227552,17423.672397,18424.082861,19519.996159,20645.932501,21886.273836,23238.972156,24657.837539,26209.677686,27913.451716,29716.515452,31690.486478,33841.538636,36193.358979,38765.025448,41576.539227,44708.817643,48088.190201,51868.421553,56138.123585,60659.084105,66445.539995,70368.755913,78649.436351,87653.498682,94296.568922,104860.22563,116142.52856,129539.66014,145278.8309,163845.01627,186221.10403,213270.56762,246406.62549,287872.93041,340241.65287,408500.4581,498116.51473,623963.48298,790139.55335,1052948.3036,1490187.2321,2112242.7679];
	chft = [16.538183895,6.5381838952,12.690919476,14.225494008,14.211056556,12.618732215,6.2638723046,12.436757003,13.483155709,11.495865831,2.5003076144,1.494635373,8.4788491065,2.4207610529,1.2041951052,2.3960193678,8.379882366,1.1235100964,3.8858419806,16.666878019,2.7816700943,5.5401976414,24.94246066,34.229644998,51.976119333,23.674832334,12.723210002,2.7819923273,6.1488206893,2.6227249154,13.360279649,3.9361564882,0.89509439812,22.483465919,0.82895807547,10.832366383,17.499492545,9.1696634362,5.8218537098,27.542921725,4.0064593913,16.43124071,20.268577768,22.494448217,9.7536293638,28.491034328,26.282233325,16.380032371,28.19763719,50.829418869,51.515312667,35.2318318,30.587985467,22.41622633,29.747109212,38.595336822,25.871543499,37.918489181,32.454499778,42.263511708,38.491453391,43.770674728,56.425847695,30.525934491,61.470414341,53.592408144,54.159953081,59.767779532,66.768928791,63.156505304,70.605049993,74.423294723,81.701771115,78.769620817,83.219745618,98.351396712,93.374667535,98.149933147,114.02559988,105.74766735,122.98373073,122.31740975,137.74663028,136.69606912,155.46909323,141.42755796,178.82067491,163.28974238,188.02035556,194.62883537,203.46430296,221.5139528,230.47988585,236.56650381,263.25409891,270.41710055,305.07749888,279.27290394,347.83088536,369.40355463,334.55489611,422.37686094,405.93766013,473.87249854,458.57234571,541.8381186,554.07517987,571.86116191,668.48017249,684.21814813,734.64723499,817.19291192,886.58111735,916.48261868,1057.4884079,1093.5637496,1258.2565936,1313.4098759,1498.1039027,1634.1745131,1745.1980448,2035.0333077,2234.6687243,2286.291795,3500.1640957,423.05182211,7857.6286158,1146.4337146,5496.6365259,5067.0201817,6215.2827471,7181.8488298,8557.3219337,10008.863436,12367.224324,14682.239268,18453.818606,23012.48631,29356.236155,38902.569072,50713.487559,75133.480692,91042.589674,171766.16061,265472.76788,356582.76788];
	dhft = [3.3333333333,6.4097011236,8.9721378279,9.4788501879,8.9432629236,6.2942015066,6.2335431026,8.6399709039,8.3263405131,4.6653911484,0.33522408047,3.3244948265,3.6332033865,1.2083187194,1.200071491,3.5919672446,3.1677974875,0.92077729474,6.8509066664,6.482849371,0.91950918235,10.1608861,19.724035219,28.735254777,25.216983889,12.132680778,3.3137392248,1.1222761207,1.175365258,3.5791849112,3.141374387,1.0136873634,7.1961238404,7.7708079983,3.8871081527,2.2223753876,2.776609703,1.1159365755,7.240356005,7.8454874445,4.1415937729,1.2791123527,0.74195681626,4.2469396177,6.2458016546,0.73626700082,3.3007336513,3.9392016062,7.5439272265,34.114910512,28.915714822,1.5479487775,2.7239197124,2.4436276273,2.9494092034,4.241264441,4.0156485605,1.8213298009,3.2696706433,1.2573527723,1.7597404459,4.2183909889,8.6333044014,10.314826617,2.6260020655,0.18918164546,1.8692754837,2.3337164197,1.2041411624,2.4828482298,1.2727482432,2.4261587974,0.97738343278,1.4833749337,5.0438836979,1.6589097255,1.591755204,5.2918889095,2.759310842,5.7453544586,0.22210699253,5.1430735115,0.35018705337,6.257674702,4.6805117546,12.464372316,5.1769775109,8.2435377271,2.2028266026,2.9451558626,6.0165499469,2.9886443497,2.0288726544,8.8958650326,2.387667215,11.553466107,8.6015316447,22.852660471,7.1908897595,11.616219509,29.273988278,5.4797336036,22.644946136,5.1000509415,27.75525763,4.0790204228,5.9286606793,32.20633686,5.2459918801,16.809695619,27.515225642,23.129401812,9.9671671098,47.001929749,12.025113896,54.897614669,18.38442743,61.564675611,45.356870124,37.007843891,96.61175431,66.545138867,17.207690222,404.62410025,1025.7040912,2478.1922646,2237.0649671,1450.0676038,143.20544806,382.75418846,322.18869423,458.49103462,483.84716729,786.12029624,771.67164777,1257.1931127,1519.5559014,2114.5832816,3182.1109723,3936.9728292,8139.9977108,5303.0363275,26907.856979,31235.535755, 30370, 30370];

///**********   spline(146,d,h,bhfd,chfd,dhfd) ;   ***********
							x_spl = d ;
                            y_spl = h; 
	bhfd=[278888785.58,320057880.76,278020731.25,234726637.74,250542597.28,230572852.64,176622660.08,150184892.01,149568814.67,129362761.7,115504489.47,94089683.617,85613878.471,81274219.065,75739060.464,71742924.369,66696796.519,60665328.723,53996487.434,48109237.07,43754769.547,39764052.857,36079102.804,33460321.559,30271738.541,27094939.017,25816906.162,23496582.015,21899277.948,20344374.244,18730274.873,17359272.694,16113198.714,15042704.503,13999966.644,13034708.731,12233965.578,11497967.663,10690190.548,10054879.808,9603753.6935,8904696.3476,8392837.3171,8040032.6415,7586793.3494,7166741.5805,6835385.6552,6514933.5271,6213124.7265,5878742.8959,5921526.4364,5974566.734,5660531.4721,5501951.08,5317035.9991,5159732.7818,5002211.7182,4848018.0082,4700078.7381,4589469.0352,4461168.16,4350921.2529,4266922.5946,4155715.7321,4059659.709,3984066.2093,3903551.7469,3826092.4258,3759016.0938,3697883.811,3633228.734,3576812.2329,3526437.3019,3475992.0281,3424202.0081,3381473.1876,3341798.2944,3301152.1362,3264949.186,3230571.7505,3196185.6626,3165087.4151,3138329.416,3112663.0113,3088744.197,3061501.5964,3038656.3247,3019719.508,2997821.0272,2980350.1488,2960644.8577,2945589.4474,2930604.2603,2913386.8766,2899585.0325,2886228.5612,2874599.0633,2862167.466,2850705.5025,2842104.2508,2829796.1546,2821375.1794,2813148.3103,2804790.7532,2796342.8831,2787852.6843,2783279.385,2775174.5022,2769788.7103,2764079.6504,2758122.2623,2753036.6661,2748543.7871,2744170.5897,2739409.9479,2734756.8813,2731793.9366,2728321.5885,2724419.2178,2721749.3977,2718711.3442,2715992.5408,2714504.5248,2707213.6117,2721803.9016,2655768.7838,2697878.6552,2759122.1707,2683196.3153,2704832.719,2696403.3774,2699559.0317,2686809.5949,2730629.7765,2551055.9979,3262703.6343,3155069.1355,2205444.5979,2832014.3536,2648707.155,2700753.259,2689378.0438,2672636.6362,2673703.2631,2723794.2747,2627226.5103];
	 chfd=[10486491108000,1913838765300,-14613883934000,4181572244900,-370497656980,-4441489005600,-6413680523100,2432088947100,-2525011622900,-179948614850,-1491736816900,-658344091720,-71699417858,-27827311490,-137904223550,-145509683850,-19089883950,-17464466330,-189772893460,-94635336659,-92251681522,-63029123528,-67642864183,-15229960002,-80811697164,992613637.58,-31714557278,-19169744184,-12840357352,-16007577793,-11350038665,-9774802305.5,-7874970779.7,-6118417603.4,-6295128332.2,-4288840014.8,-3799474661.2,-3015320852,-3888757054.8,-1074608100,-2194421713.5,-2497238326.2,-623853323.05,-1380718697.4,-992261889.42,-1046824367.7,-425868633.6,-898313713.69,-253628273.23,-927932965.64,1067293032.2,-883125332.31,-136469673.71,-345537597.22,-182791205.26,-240066905.82,-155714660.86,-209673277.54,-118351711.59,-113049340.62,-139511437.23,-64272124.985,-82322391.999,-99983939.991,-48709594.321,-61485011.662,-49111777.298,-51354268.215,-30646137.632,-39945413.017,-30561759.21,-27539683.781,-21463167.351,-24901974.009,-20093699.326,-15016260.019,-15787228.456,-14077693.104,-11098211.027,-11503653.262,-9907360.3523,-8407273.0498,-6516318.1896,-7035109.8347,-4924297.2993,-7968556.7626,-2271367.7936,-5766330.3045,-3038848.9564,-3614189.2632,-3489376.3719,-1648988.9445,-3195882.4138,-2070983.1917,-1928392.1018,-1733925.2251,-1283588.5034,-1767110.2206,-898462.67748,-990676.72099,-1561281.8498,-91510.153221,-1433961.5755,-28940.075426,-1366710.0295,43837.043376,-715590.75214,-406037.10118,-296610.23762,-403630.15507,-283417.25241,-267866.88785,-189005.09148,-227886.94014,-197550.21952,-191209.62657,-40216.187628,-212815.0814,-52201.600038,-116411.52111,-61762.981569,-86207.163938,11353.501444,-350008.94712,974005.60356,-3568705.7132,5084103.4187,-3071103.3041,799982.0288,-213693.18118,7440.4815911,61948.108182,-312546.36309,1077937.6448,-3848111.9413,13462373.443,-15114907.47,7132521.5778,-1745917.7632,423030.48442,-112866.69614,57944.743515,-121850.56337,124973.92175,-16902.699277,-128425.62425];
	dhfd=[-86070806650000000,-1664423232600000000,1509675195100000000,-365628104570000000,-326987256910000000,-132273072940000000,444064732440000000,-249225770240000000,104643596970000000,-52745806274000000,2789132279600000,16843085669000000,-5553056372100000,3518017327200000,-179798115990000,-1008647903300000,328367195930000,-275559747920000,1532005745700000,3410093186000,379021504460000,54535941548000,552878736080000,-658451176320000,685128231170000,-262076690030000,91701850106000,42280473158000,-19587015717000,26313780388000,8090582224500,8969931660900,7653826476500,-701233050880,7332925136600,1647694793300,2420227806300,-2488422230200,732851290300,-2704863800700,-677442086510,3807693095800,-1433457148500,677935092530,-88288799861,919934420930,-650750799020,820210484040,-79423403110,2166369161600,-2257428662600,808068894590,-211821604370,154996563780,-51322312335,70646771328,-42621340188,67495614149,3697608770.1,-17363580454,46358171438,-10500446198,-9651119121.3,26457350707,-6207685782.6,5665400349.8,-969516176.53,8438521019.9,-3579397762,3410997385.6,1037444362.6,1970336066.7,-1053555961.3,1392491944.2,1390698248.9,-199525993.15,418695898.18,690654167.13,-88854314.115,331318578.28,294481213.68,351543941.28,-91304407.791,351802089.23,-480242855.86,851216041.98,-494476869.12,365565118.37,-73031265.142,14997944.16,209372858.64,-166709070.95,114703703.69,13772924.748,17774140.997,38949725.107,-39551878.708,67337018.848,-6751156.2709,-39436390.132,96157781.916,-82974931.84,81978032.559,-73669803.075,73259949.768,-37183107.889,14279622.242,4758724.225,-4375482.1311,4621262.5477,561892.12516,2673100.0056,-1235521.0885,903685.45174,176583.75686,3931199.4308,-4192448.0501,3635845.6449,-1351730.897,1068334.9859,-443456.01337,1635908.3351,-5594971.8762,18875125.462,-59498511.025,103795512.83,-89350586.41,38597761.887,-9155965.1165,1803597.3702,399516.44452,-2453642.0006,8095693.9372,-25330379.623,77954090.717,-146250906.67,62336062.56,-25442570.326,5217605.684,-1064542.6963,274904.62616,-228773.40521,240921.89861,-102032.80908,-55944.961963,-55944.961963];	

///**********   spline(146,t,d,bdft,cdft,ddft) ;   ***********
							x_spl = t;
                            y_spl = d; 
	bdft=[0.0000036613829837,0.0000031202836829,0.0000037474822845,0.000004269787179,0.0000040733689997,0.0000043367368224,0.0000059396837107,0.0000067345283349,0.0000069322029496,0.0000078366598665,0.0000090011575843,0.000010908709796,0.00001207400323,0.000012825277282,0.00001372488764,0.000014475172158,0.000015674423727,0.000017327132935,0.000019417044532,0.000022004688938,0.000024564199717,0.000026738512194,0.000030181751506,0.00003193448178,0.000036480321372,0.000041144232732,0.000043142747701,0.000047884776464,0.000051818146444,0.000056242637762,0.000061911302509,0.000067812152201,0.000073340088687,0.000080127493049,0.000087649939116,0.000094872750489,0.00010345905893,0.00011229101379,0.00012237688591,0.00013320144258,0.00014281734376,0.00015652918239,0.0001700659267,0.00018320711082,0.00019810563003,0.00021537036905,0.00023341289378,0.00025197805584,0.00027067488284,0.00030032241278,0.00029803546604,0.00029253572307,0.00031982164167,0.00033917771026,0.00036046751728,0.00038495222063,0.00040972360021,0.00043615337853,0.00046466288566,0.00049219507884,0.00052455679899,0.00055657772521,0.00059113230016,0.00062789307414,0.0006652954033,0.00070692531268,0.00074900334599,0.00079406130336,0.00084175144057,0.00089093293435,0.00094351682202,0.00099899977758,0.0010574840676,0.0011190639518,0.0011832601251,0.001251895548,0.0013241576831,0.0013984737195,0.0014789474388,0.0015627365253,0.0016511064598,0.0017448376353,0.001842542999,0.0019459903686,0.0020554955265,0.0021710275253,0.0022923943721,0.0024203949861,0.0025550256835,0.00269850228,0.0028509651965,0.0030096369338,0.0031794870681,0.0033584147939,0.0035468537564,0.0037481701807,0.0039634655209,0.0041849677355,0.0044216635369,0.0046873781169,0.0049568239955,0.0052393259013,0.0055498723995,0.0058791845006,0.006231389598,0.0066082571073,0.0070135819729,0.007439415001,0.0079017580231,0.0084075529065,0.0089400303509,0.0095203256899,0.010155666889,0.010829006752,0.011568306102,0.012374768841,0.013248618533,0.014208757027,0.015260353358,0.016426829541,0.01768732848,0.019098856541,0.020676245358,0.022420162029,0.024376106526,0.026571411867,0.029052246006,0.031855604108,0.035090337561,0.038788045646,0.043076479854,0.047947034938,0.054197380393,0.059647443488,0.073440845654,0.063121173894,0.091533458769,0.12303899103,0.12216557711,0.15295670052,0.18511162082,0.23135081621,0.29674311435,0.39208672639,0.54990998009,0.79221335324];
	cdft=[-0.0000004830496504, -0.000000058049650398, 0.00000068524825199, -0.00000016294335756, -0.000000033474821733, 0.0000002968426445, 0.0000013061042437, -0.00000051125961949, 0.0000007089342342, 0.00000019552268268, 0.00000096897503508, 0.000000938577177, 0.00000022671625694, 0.00000052455779526, 0.00000037505256203, 0.00000037523195662, 0.00000082401961149, 0.00000082868959743, 0.0000012612219988, 0.0000013264224073, 0.0000012330883718, 0.00000094122410532, 0.0000025020152069, -0.0000007492849328, 0.0000052951245243, -0.00000063121316458, 0.000002629728134, 0.0000021123006288, 0.000001821069351, 0.0000026034219671, 0.0000030652427805, 0.0000028356069109, 0.0000026923295758, 0.000004095074786, 0.0000034273712803, 0.0000037954400927, 0.0000047908683488, 0.0000040410865119, 0.0000060447856034, 0.0000047797710744, 0.0000048361300991, 0.0000088757085291, 0.0000046610357846, 0.0000084801483327, 0.0000064183708847, 0.000010846368129, 0.0000071961566012, 0.000011369005467, 0.0000073278215324, 0.000022319708404, -0.000024606655147, 0.000019106912186, 0.0000081790064051, 0.000011177062194, 0.000010112744818, 0.000014371958534, 0.000010399421048, 0.000016030357276, 0.000012479149847, 0.000015053043335, 0.000017308676813, 0.000014712249412, 0.000019842325539, 0.000016918448433, 0.000020483880728, 0.000021146028653, 0.000020932004659, 0.000024125952709, 0.000023564184503, 0.000025617309278, 0.000026966578385, 0.000028516377184, 0.00002996791288, 0.000031611971296, 0.000032584201935, 0.000036051220962, 0.000036210914216, 0.000038105122174, 0.000042368597089, 0.00004142048947, 0.00004694944503, 0.000046781730409, 0.000050923633334, 0.000052523736257, 0.00005698142164, 0.000058550577185, 0.000062816269621, 0.000065184344332, 0.00006944635305, 0.000074030243469, 0.000078432673073, 0.000080239064237, 0.000089611069977, 0.000089316655853, 0.00009912230661, 0.00010219411771, 0.00011310122257, 0.00010840099203, 0.00012829480931, 0.00013741977071, 0.00013202610783, 0.00015047579796, 0.00016007070032, 0.00016924140075, 0.00018296369668, 0.00019390381255, 0.00021142105314, 0.0002144119749, 0.00024793104724, 0.00025786383612, 0.00027461360829, 0.00030568173072, 0.00032965946884, 0.00034368039394, 0.00039561895542, 0.00041084378438, 0.00046300590706, 0.0004971325874, 0.00055446374336, 0.00061201243918, 0.00064848649994, 0.00076304156107, 0.00081434725579, 0.00092956941578, 0.0010263750811, 0.0011689302599, 0.0013119038794, 0.0014914542224, 0.001743279231, 0.0019544288538, 0.002334005354, 0.0025365497302, 0.0037137957251, 0.0017362673695, 0.012057134797, -0.022376806557, 0.050789091432, -0.019283559172, 0.018410145256, 0.012380978147, 0.019773942155, 0.026465253234, 0.038927044909, 0.056416567129, 0.10140668657, 0.14089668657];
	ddft=[0.00000014166666667, 0.00000024776596746, -0.00000028273053652, 0.00000004315617861, 0.00000011010582208, 0.00000033642053308, -0.00000060578795441, 0.00000040673128456, -0.00000017113718384, 0.0000002578174508, -0.000000010132619362, -0.00000023728697335, 0.000000099280512774, -0.000000049835077743, 0.00000000005979819661, 0.00000014959588496, 0.000000001556661979, 0.000000144177467136, 0.00000002173346951, -0.000000031111345168, -0.000000097288088837, 0.00000052026370052, -0.0000010837667132, 0.0000020148031524, -0.0000019754458963, 0.0000010869804328, -0.00000017247583507, -0.000000097077092574, 0.00000026078420536, 0.00000015394027112, -0.00000007654528985, -0.000000047759111721, 0.00000046758173673, -0.00000022256783521, 0.00000012268960413, 0.00000033180941871, -0.00000024992727897, 0.00000066789969716, -0.00000042167150969, 0.000000018786341595, 0.0000013465261433, -0.0000014048909148, 0.000001273037516, -0.00000068725914933, 0.0000014759990813, -0.0000012167371758, 0.0000013909496218, -0.0000013470613114, 0.0000049972956238, -0.000015642121184, 0.000014571189111, -0.0000036426352602, 0.00000099935192973, -0.00000035477245873, 0.0000014197379052, -0.000001324179162, 0.0000018769787429, -0.0000011837358097, 0.00000085796449589, 0.00000075187782613, -0.00000086547580042, 0.0000017100253756, -0.00000097462570182, 0.0000011884774317, 0.00000022071597487, -0.000000071341331217, 0.00000106464935, -0.00000018725606875, 0.00000068437492499, 0.0000004497563688, 0.00000051659959979, 0.00000048384523204, 0.00000054801947205, 0.00000032407687976, 0.0000011556730089, 0.000000053231084632, 0.00000063140265257, 0.0000014211583051, -0.00000031603587294, 0.0000018429851867,-0.000000055904873708, 0.0000013806343082, 0.00000053336764105, 0.0000014858951276, 0.00000052305184846, 0.0000014218974786, 0.00000078935823727, 0.0000014206695724, 0.0000015279634732,0.0000014674765347, 0.00000060213038798, 0.0000031240019134, -0.000000098138041437, 0.0000032685502524, 0.0000010239370319, 0.00000363570162, -0.000001566743512, 0.000006631272428,0.0000030416537999, -0.0000017978876275, 0.0000061498967102, 0.0000031983007867, 0.0000030569001429, 0.0000045740986417, 0.0000036467052904, 0.0000058390801968, 0.00000099697392242, 0.000011173024113, 0.0000033109296237, 0.0000055832573919, 0.000010356040809, 0.0000079925793729, 0.0000046736416997, 0.000017312853828, 0.0000050749429867, 0.000017387374225,0.000011375560114, 0.00001911038532, 0.000019182898606, 0.000012158020254, 0.000038185020377, 0.00001710189824, 0.000038407386665, 0.000032268555102, 0.000047518392928, 0.000047657873187, 0.000059850114323, 0.000083941669519, 0.0000703832076, 0.00012652550008, 0.000067514792077, 0.00039241533161, -0.00065917611853, 0.0034402891425, -0.011477980451, 0.024388632663, -0.023357550202, 0.012564568143, -0.0020097223696, 0.0024643213358, 0.0022304370265, 0.0041539305584, 0.00582984074, 0.014996706482, 0.013163333333, 0.013163333333];

///**********  spline(146,h,d,bdfh,cdfh,ddfh) ;    ***********

var bb_spl, cc_spl, dd_spl;
bb_spl=[0.036667427721, 0.030572506824, 0.037017282398, 0.04204975042, 0.040131158696, 0.042754247846, 0.058272158847, 0.065627704999, 0.067674469711, 0.07656350092, 0.087222978572, 0.10609798285, 0.11663751721, 0.12318777368, 0.13195754189, 0.13936667413, 0.14999883852, 0.16469469664, 0.18550808922, 0.20755866079, 0.22878168921, 0.25114635806, 0.27784783183, 0.29753871488, 0.33262192539, 0.36739354278, 0.38821159908, 0.42533734929, 0.45649046368, 0.49178079094, 0.5337481144, 0.57610937493, 0.62064532985, 0.6646054395, 0.71454152013, 0.76696204596, 0.81760907055, 0.86922334735, 0.93635994997, 0.99378248113, 1.0412691664, 1.1239153591, 1.1904752417, 1.2444848528, 1.3175521549, 1.3960499964, 1.4619575394, 1.5363082695, 1.6079196949, 1.7023772494, 1.690102064, 1.6748311533, 1.7653949696, 1.818238172, 1.8803127654, 1.938403304, 1.9988199941, 2.062999175, 2.127456758, 2.1788461545, 2.2417792884, 2.2981881527, 2.3435980241 , 2.4065091196, 2.4630751866, 2.5101119811 , 2.5616875101 , 2.6137294958, 2.6601650877, 2.7043309087, 2.7523292891 , 2.7958136825, 2.8356839275, 2.8769116223, 2.9203835557, 2.9572736327, 2.9924115811 , 3.0292500036, 3.0628204285, 3.0954389307, 3.1287245761 , 3.159476155, 3.1863940663, 3.2127053701 , 3.2375225729, 3.2664314905, 3.2908718534, 3.3116114116, 3.3357299034, 3.3553176113, 3.377651594, 3.3948876708, 3.4122845289, 3.4324211766, 3.4487716651 , 3.4647310167, 3.4787394727, 3.4938648386, 3.5078984848, 3.5185146089, 3.5338395479, 3.5443513736, 3.5547608054, 3.5653051974, 3.5761260532, 3.586973161 , 3.5928939429, 3.6033732662, 3.6103833983, 3.6178422338, 3.6256539733, 3.6323534181 , 3.6382893305, 3.6440890581 , 3.6504205005, 3.6566335119, 3.660595863, 3.6652602844, 3.6705046368, 3.6741095721 , 3.6782099625, 3.6819048982, 3.6838789428, 3.6939488858, 3.6735187589, 3.7656024994, 3.7117825963, 3.6241080538, 3.726322545, 3.6972390825, 3.7084276223, 3.7050215257, 3.7190401865, 3.6726665886, 3.8643696311 , 3.1064664339, 3.5322118243, 4.4206166396, 3.511473217, 3.7773866508, 3.7017862828, 3.7185104184, 3.7417024571, 3.7408129218, 3.6707129858, 3.8043098702];
cc_spl=[-5.2410899792, -0.79348516598, 7.1118925914, -2.1292509858, 0.24827870767, 2.348839263,12.864798973, -5.6534792167, 7.6406294225, 1.0741070564, 9.2749003732, 9.0503464982, 1.1822111359, 5.1161123948, 3.3163570362, 3.8078085728, 6.415426424, 7.5806289219, 12.241649725, 8.7588946274, 11.075711381, 9.8258482856, 15.128800097, 2.9362302276, 29.851816975, 1.1942699826,  17.560735692, 15.587255569, 11.981872211, 18.97455521, 17.51876954, 18.687436039, 19.054898636, 17.886369976, 23.044843654, 19.573470029, 20.944149647, 19.379504101, 32.264036377, 11.237881169, 23.67879918, 36.209746253, 10.995844246, 26.252163388, 22.78629441, 28.857022364, 13.122304413, 32.773207957, 10.366204944, 44.550977884, -51.447149411, 42.670763925, 8.2077845605, 20.511347186, 12.332353001, 17.457666817, 12.451585721, 18.403789688, 11.576481496, 11.57189529, 15.790336834, 7.9108666536, 10.473696657, 14.005328839, 7.3403568259, 9.7019600295, 8.2686075468, 9.1951460738, 5.7840771189, 7.8895516528, 6.3956806164, 6.0284317849, 4.8949230013, 5.9259942705, 5.0241148963, 3.8865317286, 4.2284678994, 3.9216255832, 3.1907525603, 3.4121831116, 3.0385233642, 2.6562134628, 2.1080186325, 2.3364583534, 1.6663163026, 2.7812094757, 0.81296154359, 2.0917384835, 1.132658815, 1.362590599, 1.3478441899, 0.6447658502, 1.2690799217, 0.83946958159, 0.79068879297, 0.72204595422, 0.5399771071, 0.75389508035, 0.38890998473, 0.43023539744, 0.6900086795, 0.04048650197,  0.64434454288, 0.013036504098,  0.62498565262, -0.019340325189,  0.33145323658, 0.19042541036, 0.13946315811, 0.19115898392, 0.13514592592, 0.12840422281, 0.091038009332, 0.11027152273, 0.096098830487,  0.093553529507,  0.019688857004, 0.10479530245, 0.025856227424,  0.05774616685,  0.030662424356,  0.043339892878,  -0.0067631922742, 0.17922325401, -0.50171933638, 1.8378153963, -2.5723575424, 1.5319571329, -0.39938659312, 0.10753047099, -0.0061023156154, -0.021661757928, 0.12385348266, -0.42435632077,  1.522060412, -5.3237417784, 7.1811886195, -3.8460853262, 0.94147375258, -0.22814837639, 0.060646342566,  -0.030619347369,  0.063543877165,  -0.06452344458,  0.0087091717414, 0.066091858714];
dd_spl=[1.467856374,  2.5834567835,  -3.0498823687,  0.77697048807, 0.6932543087, 3.4365881407,  -6.0517248987, 4.3023005305, -2.1459223418,  2.6539784197,  -0.072671156954, -2.5463221237, 1.2608657881 ,  -0.57684466623, 0.15751651815, 0.83577495232, 0.36990555489, 1.4796891438,  -1.1056365389,  0.72174976736, -0.38936545018, 1.6520099102,  -3.7286146391 ,  8.38491799,  -8.5290318431 , 4.9148545674,  -0.58734527475, -1.0635349138,  2.0446441516,  -0.42196686089, 0.3329534186, 0.10380299367, -0.32731895244, 1.4094190376,  -0.94075165981, 0.36551456479, -0.40745977762, 3.3037262247,  -5.3096351536,  3.0492446105,  3.0267988099,  -5.9607333348,  3.5071998026,  -0.77536218727, 1.3312999898,  -3.3407044482, 4.043395791 ,  -4.4993981954,  6.6249559962,  -17.977177396, 18.030251597, -6.4537414541 ,  2.2289062728,  -1.4425033837,  0.87612201981, -0.82608598947, 0.95387884095, -1.0584973942,  -0.00068861943507, 0.6113683397, -1.1035672522,  0.3458609991, 0.45805864878, -0.83836125952, 0.28521777821, -0.16647531738, 0.10363965626, -0.36678160805, 0.21728323363, -0.14820149171, -0.034976079188, -0.10351678389, 0.090207460124, -0.075724548631, -0.09159284764, 0.026323030848, -0.022628489394, -0.051615326476, 0.014941332751, -0.024138226576, -0.023599376634, -0.032341877893, 0.012862596896, -0.036029142513, 0.057174008874, -0.096482741768, 0.059700137252, -0.042739735672, 0.0097635577039, -0.00059653758188, -0.027093577639, 0.022893805337, -0.014995125311, -0.0016211627989, -0.0021688100712, -0.0054675329465, 0.0060997426079, -0.0099073044416, 0.0010628964175, 0.0063297583348, -0.015045683983, 0.013242500897, -0.013119452177, 0.012027302447, -0.011991922163, 0.0061640056541, -0.0023410993729, -0.00079940787846, 0.00076382721363, -0.00077990891116, -0.000088404184618, -0.00046045857639, 0.00022253284046, -0.00015398405308, -0.000025898463372, -0.0007036741212, 0.00075710742322, -0.00065553126577, 0.00024652086754, -0.00019465101692, 0.000084634945738, -0.0003094502202, 0.0010617482804, -0.0035829654848, 0.011315219252, -0.020063568258, 0.016234779777, -0.0071333101607, 0.0016956583513, -0.00034337408699, -0.000042276497968, 0.00035358711325, -0.0011841407539, 0.0037151029408, -0.011446298472, 0.018185550947, -0.013798926278, 0.0050985719689, -0.0010458555797, 0.00021328689307, -0.000054620350549, 0.00004455954218, -0.000047009775736, 0.000019436181462, 0.000010709541455, 0.000010709541455];
						x_spl = h ;
                        y_spl = d ;
                            bdfh=[];cdfh=[];ddfh=[];
                            
	for (var i=0;i< 146;i++){				  
		bdfh[i]=bb_spl[i]*0.0000001;		////*e-07   
		cdfh[i]=cc_spl[i]*0.0000000000001;  /////*e-13   
		ddfh[i]=dd_spl[i]*0.0000000000000001;   ////*e-16
							  }

///**********  spline(146,h,t,btfh,ctfh,dtfh) ;    ***********
							x_spl = h;
                            y_spl = t; 
  
		btfh=[0.0010028664994,  0.00098054060808,  0.00098650743312,  0.0009850245225,  0.00098500402223,  0.00098656873294,  0.00098031489821,  0.00097452461541,  0.00097550027722,  0.00097739738523,  0.0009688146923,  0.00097258656403,  0.00096608177002,  0.00096039951967,  0.00096155092051,  0.0009626275675,  0.00095716957873,  0.00095052590416,  0.00095501251891,  0.00094370973449,  0.00093130992505,  0.00093852720081,  0.00092205790721,  0.00092966737081,  0.00091583843319,  0.00089126967457,  0.00090053384226,  0.00088796246912,  0.00088107382938,  0.00087423051584,  0.00086229663738,  0.00084955283545,  0.00084599054539,  0.0008298733775,  0.00081492572719,  0.00080845869056,  0.00079038066964,  0.00077402735018,  0.00076503527842,  0.00074630641501,  0.00072880563156,  0.00071829534745,  0.00069977074263,  0.00067952543309,  0.000664795693,  0.00064848552223,  0.00062616647624,  0.00060984722564,  0.00059367331277,  0.00056723719865,  0.00056751667444,  0.00057260655797,  0.00055185053925,  0.00053612558299,  0.00052155559318,  0.00050367119602,  0.00048771298309,  0.00047311282191,  0.00045777391003,  0.00044270948172,  0.00042738133972,  0.00041285634074,  0.00039655261469,  0.00038317199214,  0.00037028760676,  0.00035505527585,  0.00034200536288,  0.0003291696361,  0.00031602581778,  0.00030353504513,  0.00029171299164,  0.00027985865975,  0.00026815785813,  0.00025708105765,  0.00024680039294,  0.00023623604989,  0.00022597996377,  0.00021660536352,  0.00020710888761,  0.00019806209009,  0.00018950610975,  0.00018106535385,  0.00017294290479,  0.00016508545061,  0.00015751531899,  0.00015044439042,  0.0001435667143,  0.00013681322278,  0.00013055964279,  0.00012433850284,  0.0001184751359,  0.00011279820058,  0.00010732572172,  0.0001021987724, 9.723928029e-05,  9.2432729236e-05,  8.7777845355e-05,  8.3477045102e-05,  7.9339022395e-05,  7.5066776551e-05,  7.1285204385e-05,  6.7654971323e-05,  6.4047431433e-05,  6.0645591171e-05,  5.7386566208e-05,  5.4281356683e-05,  5.122866019e-05,  4.8433087526e-05, 4.5694037961e-05,  4.3029505322e-05,  4.055492215e-05,  3.8153972496e-05,  3.5826253185e-05,  3.3648777582e-05,  3.155806211e-05,  2.9546700323e-05,  2.7631882852e-05,  2.5794398674e-05,  2.4053085335e-05,  2.2367161228e-05,  2.0794021217e-05, 1.9279635474e-05, 1.7817125057e-05, 1.647204211e-05, 1.5081776256e-05,  1.4148878265e-05,  1.2805308435e-05,  1.1352094796e-05, 1.0633579344e-05,  9.5247116459e-06,  8.6142089975e-06,  7.7180720576e-06,  6.884136077e-06,  6.1024061598e-06,  5.3707998301e-06,  4.6880476974e-06,  4.0587048895e-06,  3.4735628125e-06,  2.9386668732e-06,  2.4487237156e-06,  2.0055316085e-06, 1.6060952492e-06, 1.2599367023e-06,  9.551911914e-07,  6.6263586878e-07,  5.0825098863e-07];
		ctfh=[-1.5818393147e-08, -6.286449698e-09, 1.2136278174e-08, -1.3604506515e-08, 1.3584408216e-08, -1.2035189698e-08, 5.9039791781e-09, -1.1580727015e-08, 1.2527971488e-08, -1.0668061678e-08, 2.3353500949e-09, 1.3266612987e-09, -7.6419952896e-09, 2.178293032e-09, -1.0711768385e-09, 2.1064143218e-09, -7.3544804489e-09, 1.027171342e-09, 3.2457950808e-09, -1.4010351665e-08, 2.4217447103e-09, 4.323372824e-09, -1.9715236006e-08, 2.6696395276e-08, -3.9620636046e-08, 1.7684244419e-08, -9.3381473936e-09, -1.8862929118e-09, -4.2098484517e-09, -1.7930581645e-09, -8.5842274486e-09, -2.3079109578e-09, -7.10978924e-10, -1.2832859634e-08, 5.8068724387e-10, -5.8384406016e-09, -8.6239761358e-09, -4.1520546881e-09, -2.764923587e-09, -1.1423609299e-08, -1.4446138299e-09, -6.1715340786e-09, -6.966483522e-09, -6.995798917e-09, -2.8899326914e-09, -7.8404428137e-09, -6.3755100439e-09, -3.6981014371e-09, -6.0452195726e-09, -9.3246142177e-09, 9.481623092e-09, -6.5564026742e-09, -5.1042820008e-09, -3.4418898762e-09, -4.2670994441e-09, -4.9043862786e-09, -2.9957191297e-09, -4.0235891334e-09, -3.1107884837e-09, -3.6749900331e-09, -2.9894195353e-09, -3.11352121e-09, -3.4871775967e-09, -1.7192903207e-09, -3.142741897e-09, -2.376218581e-09, -2.1707894195e-09, -2.1365014484e-09, -2.103439945e-09, -1.7636723315e-09, -1.7547959676e-09, -1.6321560016e-09, -1.5735430725e-09, -1.3337536402e-09, -1.2558344481e-09, -1.2959392362e-09, -1.072671878e-09, -1.0013547255e-09, -1.0106105095e-09, -8.2072501998e-10, -8.3741070446e-10, -7.256922408e-10, -7.1190936324e-10, -6.1536330149e-10, -6.0562567036e-10, -4.8220949338e-10, -5.2921346601e-10, -4.1665369385e-10, -4.1938641109e-10, -3.7311549389e-10, -3.3845816409e-10, -3.1783493663e-10, -2.841979403e-10, -2.5265537774e-10, -2.4181044946e-10, -2.1378680684e-10, -2.0557210136e-10, -1.6233211183e-10, -1.7464042131e-10, -1.5500817781e-10, -1.2142253609e-10, -1.3085217283e-10, -1.0648597784e-10, -1.0559882652e-10, -8.6560664197e-11, -8.6817868745e-11, -7.4104455618e-11, -6.5117290596e-11, -6.3779159553e-11, -5.4329556682e-11, -4.9036490614e-11, -4.5414715273e-11, -4.0637754667e-11, -3.4942793833e-11, -3.3203082054e-11, -2.8193797893e-11, -2.6530908351e-11, -2.2507900767e-11, -2.0873099213e-11, -1.8225326272e-11, -1.569317331e-11, -1.4637003802e-11, -1.2461577212e-11, -1.0574609585e-11, -1.1371181316e-11, -2.164773282e-12, -1.6172470208e-11, -1.0722626639e-12, -6.8891273798e-12, -4.238496286e-12, -4.0155391443e-12, -3.2891310539e-12, -2.7900062104e-12, -2.275635624e-12, -1.9135898097e-12, -1.5111299568e-12, -1.2345740173e-12, -9.6207016412e-13, -7.4686254927e-13, -5.6743316814e-13, -4.1451416004e-13, -3.0264539857e-13, -1.8877786497e-13, -1.4681168116e-13, -8.6123804022e-14, -3.1644622508e-16];
		dtfh=[3.1458559237e-12, 6.0204993046e-12, -8.4953084782e-12, 8.8852662518e-12, -8.4553128428e-12, 5.862473489e-12, -5.71395627216e-12, 7.8021678002e-12,-7.5804029956e-12, 4.2082238748e-12, -3.2643650363e-13, -2.9024778603e-12, 3.14752830826e-12, -1.0414967534e-12, 1.01845870526e-12, -3.03233806756e-12, 2.6608418384e-12, 7.0432499644e-13, -5.47814182426e-12, 5.1190331388e-12, 5.9240751206e-13, -7.488663187e-12, 1.4193159413e-11, -2.0659511315e-11, 1.7055023948e-11, -8.11483237626e-12, 2.2178138339e-12, -6.8541461355e-13, 7.06663826666e-13, -1.9684548649e-12, 1.78812435646e-12, 4.511107446e-13, -3.3954847928e-12, 3.6649035186e-12, -1.73960104216e-12, -7.4280947578e-13, 1.164562877e-12, 3.5567464132e-13, -2.186536796e-12, 2.4458322228e-12, -1.141768176e-12, -1.879313105e-13, -6.7391712652e-15, 9.1853830551e-13, -1.0856381847e-12, 3.1102606577e-13, 5.5090712074e-13, -4.7130886256e-13, -6.3554159787e-13, 3.5217672865e-12, -3.0724187292e-12, 2.7193271036e-13, 3.011579936e-13, -1.4553960634e-13, -1.0893792042e-13, 3.1496157572e-13, -1.64722757e-13, 1.4151948057e-13, -8.471494736e-14, 9.9358043166e-14, -1.7381186941e-14, -5.0425963117e-14, 2.2929796057e-13, -1.7905051274e-13, 9.2575279707e-14, 2.3859368357e-14, 3.835343518e-15, 3.5550003665e-15, 3.5063737205e-14, 8.8059165887e-16, 1.1679996759e-14, 5.3527789148e-15, 2.0978952959e-14, 6.542333504e-15, -3.2290489603e-15, 1.7187633429e-14, 5.2593770257e-15, -6.5365706133e-16, 1.2812786066e-14, -1.0778865942e-15, 6.8962014604e-15, 8.1314911896e-16, 5.4361521252e-15, 5.2352855544e-16, 6.3290347168e-15, -2.304116305e-15, 5.254891324e-15, -1.2177884325e-16, 1.9647947854e-15, 1.4019955424e-15, 7.947293819e-16, 1.2334798798e-15, 1.1009620442e-15, 3.6041636009e-16, 8.8542314758e-16, 2.4668785226e-16, 1.2329623476e-15, -3.3410177756e-16, 5.0494453469e-16, 8.1836358956e-16, -2.1843031605e-16, 5.3434638142e-16, 1.843622859e-17, 3.7417771864e-16, -4.7869820855e-18, 2.23395064616-16, 1.4918932638e-16, 2.0990290872e-17, 1.3962179184e-16, 7.3699054126e-17, 4.7492464477e-17, 5.8865811539e-17, 6.5891019712e-17, 1.8901692522e-17, 5.0969517303e-17, 1.5841569418e-17, 3.5788698374e-17, 1.3575830877e-17, 2.0468250933e-17, 1.8198598265e-17, 7.0510014541e-18, 1.3436023657e-17, 1.0772207723e-17, -4.1913798006e-18, 4.4527026667e-17, -6.3726386088e-17, 5.9729470923e-17, -2.1484264879e-17, 8.8664696228e-18, 6.7372901135e-19, 1.9737204933e-18, 1.21282218876e-18, 1.1110475774e-18, 6.9103262773e-19, 6.729197648e-19, 4.0218713466e-19, 3.4099638766e-19, 2.2918808823e-19, 1.6044260343e-19, 1.1293703793e-19, 6.6950800147e-20, 5.388393602e-20, 1.5404561154e-20, 1.6106765698e-20, 1.6014542084e-20, 1.6014542084e-20];


///**********  spline(146,d,t,btfd,ctfd,dtfd) ;    ***********
							x_spl = d;
                            y_spl = t; 
  
  		btfd=[279788.18229, 314099.61696, 273785.39014, 231332.01153, 246669.69628, 227772.33589, 172839.87188, 146434.62417, 145738.48474, 126553.42202, 111839.13048, 91523.544909, 82716.197829, 78043.200519, 72837.780553, 69046.530845, 63859.188528, 57658.406072, 51548.033176, 45428.466809, 40737.845098, 37297.717464, 33321.796599, 31029.169234, 27837.229148, 24087.401021, 23276.710574, 20852.399833, 19299.593793, 17781.692007, 16155.006962, 14746.274421, 13628.486736, 12489.304182, 11403.934325, 10539.733605, 9670.0783922, 8899.2281716, 8177.5825938, 7505.3171377, 6997.2545346, 6398.0983212, 5871.5697058, 5464.8416835, 5042.1370138, 4648.9074165, 4279.2557023, 3973.6108636, 3687.4442406, 3335.8667087, 3362.2656386, 3421.5739158, 3123.035466, 2950.0360094, 2772.8816044, 2599.1361186, 2439.3038136, 2293.9565642, 2151.3798579, 2031.8620981, 1906.6655633, 1796.1922996, 1692.1887058, 1592.2413329, 1503.2825994, 1414.5650171, 1335.0101247, 1259.4679191, 1187.9123352, 1122.4564811, 1059.8504884, 1001.0076697, 945.63308751, 893.61919144, 845.08986507, 798.82625344, 755.17879669, 715.04671221, 676.20114549, 639.85024175, 605.70074411, 573.08539509, 542.74993068, 513.85940372, 486.51622477, 460.59860755, 436.23410831, 413.14923779, 391.38739045, 370.57414226, 350.76595975, 332.25024394, 314.53573819, 297.74070053, 281.95493937, 266.78189929, 252.32499541, 238.92674038, 226.17105424, 213.34656279, 201.72670237, 190.87304145, 180.18266474, 170.09005861, 160.48026619, 151.32187977, 142.58758598, 134.40875495, 126.56285133, 118.93741623, 111.85501497, 105.03960697, 98.469681328, 92.338183538, 86.450307451, 80.803549463, 75.48356015, 70.37657805, 65.529730417, 60.878506338, 56.532185866, 52.364874294, 48.360354971, 44.60533845, 41.021893324, 37.635452553, 34.420404076, 31.39033996, 28.500562684, 25.776269565, 23.224738884, 20.829027643, 18.520578308, 16.59292034, 13.878532485, 14.975366327, 13.205356413, 7.3429455418, 8.4907305183, 6.4158551495, 5.4435769976, 4.3074506187, 3.3758167651, 2.5449382199, 1.8156857856, 1.3080477756];
		ctfd=[9017613338.7, 1317156138.1, -13496680855, 3266951068.1, 428876582.86, -4982457399.5, -6070352260.4, 2093658327.6, -2198656732.6, -369624756.55, -1405319939.7, -634397487.53, -124202605.43, -252652016.35, -138732943.54, -130150014.49, -215672806.63, -160132190.7, -173767967.55, -121863257.9, -79450978.614, -54406127.781, -86583973.798, 14032474.908, -110175248.6, 15958461.511, -35446212.652, -17718496.568, -13399860.958, -14761582.19, -12809350.778, -8896851.7087, -6935835.0371, -7955440.1825, -4965629.5393, -4510255.5513, -4274140.5393, -2863361.5038, -3304549.4171, -1947524.4587, -1734088.6074, -2287094.0328, -923446.30498, -1387508.3671, -825605.08712, -1083276.453, -559620.05471, -703375.14639, -388863.87285, -853459.56131, 939449.56113, -733518.0432, -235762.63804, -290071.57645, -216083.86649, -250973.89092, -150614.81524, -193809.9462, -122324.65759, -127712.4969, -118737.37475, -85464.591302, -96042.553342, -67805.598905, -69901.418886, -59424.50281, -49854.195582, -48125.318833, -39350.945012,  -36233.182135, -32039.438058, -28560.787172, -25305.537942, -22501.351823, -19661.399154, -18353.072193, -15534.704787, -13952.499093, -13061.107803, -10838.237196,  -10425.459964,  -8782.6372242, -8136.1940126, -7117.5161039, -6554.0733725, -5711.7180231, -5209.1691281, -4589.1630132, -4161.0771729, -3764.7599111, -3375.8970861, -2943.4598477, -2783.8294351, -2353.8388586, -2220.4182153, -1939.9985871, -1811.1440918, -1476.7712534, -1489.6673824, -1327.0449946, -1082.2148886, -1048.0424083, -934.22658961, -832.37696878, -755.23122937, -671.75325499, -611.19236586, -520.6691111, -502.93214402, -432.35978522, -384.43196432, -354.36565084, -313.71708659, -270.79175894, -255.38126051, -216.40067518, -199.12610076, -173.0215419, -156.13619207, -137.61296034, -117.28824613, -109.51656351, -91.928143111, -82.488528397, -70.768041896, -62.294463844, -53.404704024, -46.189830412, -40.25021855, -33.570860957, -28.861072327, -23.817392887, -21.556640745, -12.113064556, -29.760128326, 44.578202395, -71.753519281, 22.475068722, -12.607591276, -2.3663227354, -3.4278760938, -2.0575831603, -1.4986784481, -0.93434803865, -0.63901212164, -0.1249506914];
		dtfd=[-7.7313827315e+14, -1.4918264847e+15, 1.3464764597e+15, -2.2795778998e+14, -4.3464529979e+14, -7.2964108708e+13, 4.0983988895e+14, -2.1580266768e+14, 8.1616777157e+13, -4.1644357987e+13, 2.5800617542e+13, 1.4648144763e+13, -3.4529411537e+12, 2.8551146067e+12, 2.0290612402e+11, -1.900506492e+12, 1.122032645e+12, -2.4837480603e+11, 8.3582463217e+11, 6.0675649904e+11, 3.2483593816e+11, -3.803527898e+11, 1.0613549442e+12, -1.2470654971e+12, 1.0563962321e+12, -4.1189642759e+11, 1.2958856787e+11, 28848601266, -8421281580.5, 11029556000, 20095013197, 9258813369, -4442723945, 11864327949, 1664378611.3, 795000040.29, 4354256282.4, -1256945621.9, 3533919162.6, 515545534.31, -1237148602.7, 2771641723.3, -878905420.59, 980633996.4, -416943957.82, 775787256.81, -198009768.16, 400141569.4, -547226959.32, 1946698287.1, -1936305097.6, 538696325.93, -55024253.703, 70464485.672, -31263462.751, 84052827.207, -34119376.75, 52834655.297, -3757210.1232, 5889187.7614, 20500790.789, -6153555.5785, 15430029.747, -1081434.4585, 5090824.1377, 4382008.804, 747460.76474, 3575539.4545, 1200062.6932, 1524443.5032, 1194181.5607, 1055528.2845, 859125.64937, 822459.50425, 358347.56556, 729391.15052, 387510.57905, 206627.55914, 487151.13016, 85673.979238, 322501.51934, 120179.0689, 179281.57492, 93907.121901, 132884.57949, 75085.745557, 87720.163389, 57376.469688, 50306.836988, 46727.087838, 49196.50039, 17203.406895, 43845.271386, 12887.148003, 25630.164355, 11144.654496, 27351.561424, -999.69991824, 11905.878016, 16921.010849, 2235.6872951, 7034.7869885, 5942.564959, 4248.3473432, 4335.6172423, 2965.1825855, 4175.8121025, 771.34016477, 2885.3329571, 1842.4564987, 1086.4069908, 1377.8240207, 1364.0078694, 459.05565765, 1085.5984996, 449.75329787, 634.08289888, 382.23768724, 389.94635433, 397.33181275, 140.99057763, 294.92463394, 146.15347848, 167.08702564, 110.98334056, 106.6378751, 79.048049915, 59.22259642, 60.330927025, 38.413700931, 36.967907118, 14.812171701, 54.982511172, -90.743468312, 334.76686805, -595.35474427, 264.02327856, -100.53490371, 24.636319011, -2.1087419666, 2.205355024, 0.71115612755, 0.55083495314, 0.21239548149, 0.25787655021, 0.25787655021];
	
		
	switch(metod)
	{
	case 1:{//P tvin fiin
		//  отн влажность и темп
 var m=[];
 m=tfi_hd(P,tvin,fiin);
 hout=m[0];
 dout=m[1];
 dout=(dout*100000).toFixed(0);
   result1.value=(hout/1000).toFixed(1);
	result2.value=(dout/100).toFixed(1);
	inputType1.value="Энтальпия";
	inputType2.value="Влагосодержание";
	}
	break;
	case 2 :{// Hin-энтальпия  P tvin
	
	result1.value="";//doutfinal;
	result2.value="";//fiinfinal;
	inputType1.value="";
	inputType2.value="";
		//энтальпия и темп  
		hout=0;dout=0;
			var doutfinal=0;    var fiinfinal=0;
			var min=0;			var max=0,mix=0;
			var m=[];
			var opit=100;
			while(opit>0.9){
			m=tfi_hd(P,tvin,opit/100);
				hout=m[0];
				dout=m[1];
			if(opit==100){	max=(hout/1000);}
			if(opit>1&&opit<1.01){ 	mix=(hout/1000);}
				opit=opit-0.01;
			};
			m=[];
			limitEntalpy2=max;
			limitEntalpy1=mix;
			
			fiin=100;
			m=tfi_hd(P,tvin,fiin/100);
				hout=m[0];
				dout=m[1];
			max=(hout/1000).toFixed(3);
			while(fiin>0.9)
			{
				m=tfi_hd(P,tvin,fiin/100);
				hout=m[0];
				dout=m[1];
				min=(hout/1000).toFixed(3);
				if(Hin==(hout/1000))
				{
					doutfinal=(dout*100000).toFixed(0);
					fiinfinal=fiin;
				}
				if(Hin>min&&Hin<max)
				{
						doutfinal=(dout*100000).toFixed(0);
						fiinfinal=fiin;
				}
				max=(hout/1000).toFixed(3);
				fiin=fiin-0.01;
			}
			limitchange(limitEntalpy1,limitEntalpy2);
			var proverka=doutfinal/100;
			while(proverka>100){proverka=(proverka/10).toFixed(1);}
			result1.value=proverka.toFixed(1);//doutfinal;
	result2.value=fiinfinal.toFixed(1);;//fiinfinal;
	inputType1.value="Влагосодержание";
	inputType2.value="Относительная влажность";
			
		}
	break;
	case 3:{//энтальпия и отн влажность
			var doutfinal=0;    var tfinal=0;
			var min=0;			var max=0,mix=0;
			var m=[]; 
			var opit=95;
			while(opit>-51){
			m=tfi_hd(P,opit,fiin);
				hout=m[0];
				dout=m[1];
			if(opit==95){	max=(hout/1000);}
			if(opit>-51&&opit<-49){ mix=(hout/1000);}
				opit=opit-1;
			};
			m=[];
			limitEntalpy2=max;
			limitEntalpy1=mix;
			
			tvin=95;
			m=tfi_hd(P,tvin,fiin);
				hout=m[0];
				dout=m[1];
			max=(hout/1000).toFixed(3);
			while(tvin>-51)
			{
				m=tfi_hd(P,tvin,fiin);
				hout=m[0];
				dout=m[1];
				min=(hout/1000).toFixed(3);
				if((Hin*10)==(hout/100))
				{
					doutfinal=(dout*100000).toFixed(0);
					tfinal=tvin;
				}
				if(((Hin*10)>(min*10))&&((Hin*10)<(max*10)))
				{		
						doutfinal=(dout*100000).toFixed(0);
						tfinal=tvin;
				}
				max=(hout/1000).toFixed(3);
				
				tvin=tvin-1;
			}
			limitchange(limitEntalpy1,limitEntalpy2);
			var proverka=doutfinal/100;
			while(proverka>100){proverka=(proverka/10).toFixed(1);}
result1.value=proverka.toFixed(1);//doutfinal;
result2.value=tfinal.toFixed(1);;
	inputType1.value="Влагосодержание";
	inputType2.value="Температура";
		}
	break;
	default:
	{
		if(metod==0){return false;}
		}
		break;
	};
	
	
	}
};



function tfi_hd(P,tvin,fiin)
{
	var x_spl, y_spl, b_spl, c_spl, d_spl, bhft, chft, dhft, bhfd, chfd, dhfd, bdft, cdft, ddft, bdfh, cdfh, ddfh, btfh, ctfh, dtfh, btfd, ctfd, dtfd;
var d1, h1, dout, hout;
	t=[-50.0,-49.0,-48.0,-47.0,-46.0,-45.0,-44.0,-43.0,-42.0,-41.0,-40.0,-39.0,-38.0,-37.0,-36.0,-35.0,-34.0,-33.0,-32.0,-31.0,-30.0,-29.0,-28.0,-27.0,-26.0,-25.0,-24.0,-23.0,-22.0,-21.0,-20.0,-19.0,-18.0,-17.0,-16.0,-15.0,-14.0,-13.0,-12.0,-11.0,-10.0,-9.0,-8.0,-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0];
 d=[0.00002405,0.00002737,0.00003068,0.00003483,0.00003898,0.00004313,0.00004810,0.00005474,0.00006137,0.00006884,0.00007713,0.00008709,0.00009870,0.00011110,0.00012440,0.00013850,0.00015350,0.00017000,0.00018830,0.00020900,0.00023230,0.00025800,0.00028620,0.00031780,0.00035100,0.00039080,0.00043240,0.00047800,0.00052790,0.00058180,0.00064080,0.00070570,0.00077630,0.00085280,0.00093680,0.00102800,0.00112700,0.00123500,0.00135200,0.00148000,0.00161800,0.00176700,0.00193100,0.00210700,0.00229800,0.00250400,0.00272900,0.00297100,0.00323300,0.00351600,0.00382300,0.00411100,0.00441900,0.00474800,0.00509800,0.00547000,0.00586800,0.00629000,0.00674100,0.00721900,0.00772700,0.00826800,0.00884100,0.00945100,0.01009700,0.01078300,0.01151100,0.01228200,0.01310000,0.01396600,0.01488300,0.01585400,0.01688200,0.01797000,0.01912100,0.02033800,0.02162600,0.02298700,0.02442500,0.02594600,0.02755200,0.02925000,0.03104300,0.03293700,0.03493700,0.03705000,0.03928100,0.04163700,0.04412400,0.04675000,0.04952400,0.05245400,0.05554700,0.05881600,0.06226700,0.06591400,0.06976800,0.07384300,0.07814300,0.08269600,0.08751900,0.09261400,0.09800700,0.10372000,0.10977300,0.11619100,0.12299900,0.13022500,0.13789000,0.14604300,0.15471400,0.16393900,0.17377300,0.18426300,0.19545300,0.20742200,0.22022500,0.23394800,0.24867300,0.26450700,0.28155800,0.29993200,0.31981100,0.34134000,0.36472200,0.39017200,0.41796000,0.44838400,0.48181500,0.51871900,0.55958800,0.60506600,0.65594200,0.71319400,0.77801800,0.85203800,0.91717100,1.03613600,1.15245600,1.29102200,1.45882400,1.66594000,1.92791000,2.26941000,2.73291000,3.39739000];
 h=[-50240.0,-49230.0,-48210.0,-47200.0,-46180.0,-45170.0,-44150.0,-43130.0,-42100.0,-41080.0,-40050.0,-39020.0,-37990.0,-36950.0,-35910.0,-34870.0,-33830.0,-32780.0,-31730.0,-30680.0,-29610.0,-28540.0,-27470.0,-26380.0,-25310.0,-24190.0,-23080.0,-21960.0,-20830.0,-19690.0,-18540.0,-17370.0,-16190.0,-15000.0,-13780.0,-12550.0,-11300.0,-10020.0,-8720.0,-7400.0,-6040.0,-4660.0,-3250.0,-1800.0,-310.0,1210.0,2780.0,4400.0,6060.0,7780.0,9560.0,11300.0,13080.0,14920.0,16810.0,18760.0,20780.0,22860.0,25010.0,27230.0,29530.0,31910.0,34380.0,36950.0,39600.0,42360.0,45230.0,48210.0,51310.0,54540.0,57900.0,61400.0,65050.0,68860.0,72830.0,76970.0,81300.0,85820.0,90540.0,95480.0,100640.0,106040.0,111690.0,117610.0,123810.0,130310.0,137110.0,144250.0,151730.0,159580.0,167820.0,176470.0,185560.0,195110.0,205140.0,215690.0,226790.0,238480.0,250760.0,263720.0,277400.0,291790.0,306990.0,323030.0,339990.0,357900.0,376870.0,396950.0,418200.0,440760.0,464700.0,490120.0,517170.0,545980.0,576660.0,609420.0,644410.0,681880.0,722020.0,765140.0,811520.0,861450.0,915420.0,973810.0,1037160.0,1106080.0,1179350.0,1263620.0,1353870.0,1453520.0,1563830.0,1686510.0,1823690.0,1978010.0,2152650.0,2352010.0,2581220.0,2847600.0,3160600.0,3533380.0,3984720.0,4541690.0,5246090.0,6154180.0,7410130.0,9196160.0];

	bdft=[0.0000036613829837,0.0000031202836829,0.0000037474822845,0.000004269787179,0.0000040733689997,0.0000043367368224,0.0000059396837107,0.0000067345283349,0.0000069322029496,0.0000078366598665,0.0000090011575843,0.000010908709796,0.00001207400323,0.000012825277282,0.00001372488764,0.000014475172158,0.000015674423727,0.000017327132935,0.000019417044532,0.000022004688938,0.000024564199717,0.000026738512194,0.000030181751506,0.00003193448178,0.000036480321372,0.000041144232732,0.000043142747701,0.000047884776464,0.000051818146444,0.000056242637762,0.000061911302509,0.000067812152201,0.000073340088687,0.000080127493049,0.000087649939116,0.000094872750489,0.00010345905893,0.00011229101379,0.00012237688591,0.00013320144258,0.00014281734376,0.00015652918239,0.0001700659267,0.00018320711082,0.00019810563003,0.00021537036905,0.00023341289378,0.00025197805584,0.00027067488284,0.00030032241278,0.00029803546604,0.00029253572307,0.00031982164167,0.00033917771026,0.00036046751728,0.00038495222063,0.00040972360021,0.00043615337853,0.00046466288566,0.00049219507884,0.00052455679899,0.00055657772521,0.00059113230016,0.00062789307414,0.0006652954033,0.00070692531268,0.00074900334599,0.00079406130336,0.00084175144057,0.00089093293435,0.00094351682202,0.00099899977758,0.0010574840676,0.0011190639518,0.0011832601251,0.001251895548,0.0013241576831,0.0013984737195,0.0014789474388,0.0015627365253,0.0016511064598,0.0017448376353,0.001842542999,0.0019459903686,0.0020554955265,0.0021710275253,0.0022923943721,0.0024203949861,0.0025550256835,0.00269850228,0.0028509651965,0.0030096369338,0.0031794870681,0.0033584147939,0.0035468537564,0.0037481701807,0.0039634655209,0.0041849677355,0.0044216635369,0.0046873781169,0.0049568239955,0.0052393259013,0.0055498723995,0.0058791845006,0.006231389598,0.0066082571073,0.0070135819729,0.007439415001,0.0079017580231,0.0084075529065,0.0089400303509,0.0095203256899,0.010155666889,0.010829006752,0.011568306102,0.012374768841,0.013248618533,0.014208757027,0.015260353358,0.016426829541,0.01768732848,0.019098856541,0.020676245358,0.022420162029,0.024376106526,0.026571411867,0.029052246006,0.031855604108,0.035090337561,0.038788045646,0.043076479854,0.047947034938,0.054197380393,0.059647443488,0.073440845654,0.063121173894,0.091533458769,0.12303899103,0.12216557711,0.15295670052,0.18511162082,0.23135081621,0.29674311435,0.39208672639,0.54990998009,0.79221335324];
	cdft=[-0.0000004830496504, -0.000000058049650398, 0.00000068524825199, -0.00000016294335756, -0.000000033474821733, 0.0000002968426445, 0.0000013061042437, -0.00000051125961949, 0.0000007089342342, 0.00000019552268268, 0.00000096897503508, 0.000000938577177, 0.00000022671625694, 0.00000052455779526, 0.00000037505256203, 0.00000037523195662, 0.00000082401961149, 0.00000082868959743, 0.0000012612219988, 0.0000013264224073, 0.0000012330883718, 0.00000094122410532, 0.0000025020152069, -0.0000007492849328, 0.0000052951245243, -0.00000063121316458, 0.000002629728134, 0.0000021123006288, 0.000001821069351, 0.0000026034219671, 0.0000030652427805, 0.0000028356069109, 0.0000026923295758, 0.000004095074786, 0.0000034273712803, 0.0000037954400927, 0.0000047908683488, 0.0000040410865119, 0.0000060447856034, 0.0000047797710744, 0.0000048361300991, 0.0000088757085291, 0.0000046610357846, 0.0000084801483327, 0.0000064183708847, 0.000010846368129, 0.0000071961566012, 0.000011369005467, 0.0000073278215324, 0.000022319708404, -0.000024606655147, 0.000019106912186, 0.0000081790064051, 0.000011177062194, 0.000010112744818, 0.000014371958534, 0.000010399421048, 0.000016030357276, 0.000012479149847, 0.000015053043335, 0.000017308676813, 0.000014712249412, 0.000019842325539, 0.000016918448433, 0.000020483880728, 0.000021146028653, 0.000020932004659, 0.000024125952709, 0.000023564184503, 0.000025617309278, 0.000026966578385, 0.000028516377184, 0.00002996791288, 0.000031611971296, 0.000032584201935, 0.000036051220962, 0.000036210914216, 0.000038105122174, 0.000042368597089, 0.00004142048947, 0.00004694944503, 0.000046781730409, 0.000050923633334, 0.000052523736257, 0.00005698142164, 0.000058550577185, 0.000062816269621, 0.000065184344332, 0.00006944635305, 0.000074030243469, 0.000078432673073, 0.000080239064237, 0.000089611069977, 0.000089316655853, 0.00009912230661, 0.00010219411771, 0.00011310122257, 0.00010840099203, 0.00012829480931, 0.00013741977071, 0.00013202610783, 0.00015047579796, 0.00016007070032, 0.00016924140075, 0.00018296369668, 0.00019390381255, 0.00021142105314, 0.0002144119749, 0.00024793104724, 0.00025786383612, 0.00027461360829, 0.00030568173072, 0.00032965946884, 0.00034368039394, 0.00039561895542, 0.00041084378438, 0.00046300590706, 0.0004971325874, 0.00055446374336, 0.00061201243918, 0.00064848649994, 0.00076304156107, 0.00081434725579, 0.00092956941578, 0.0010263750811, 0.0011689302599, 0.0013119038794, 0.0014914542224, 0.001743279231, 0.0019544288538, 0.002334005354, 0.0025365497302, 0.0037137957251, 0.0017362673695, 0.012057134797, -0.022376806557, 0.050789091432, -0.019283559172, 0.018410145256, 0.012380978147, 0.019773942155, 0.026465253234, 0.038927044909, 0.056416567129, 0.10140668657, 0.14089668657];
	ddft=[0.00000014166666667, 0.00000024776596746, -0.00000028273053652, 0.00000004315617861, 0.00000011010582208, 0.00000033642053308, -0.00000060578795441, 0.00000040673128456, -0.00000017113718384, 0.0000002578174508, -0.000000010132619362, -0.00000023728697335, 0.000000099280512774, -0.000000049835077743, 0.00000000005979819661, 0.00000014959588496, 0.000000001556661979, 0.000000144177467136, 0.00000002173346951, -0.000000031111345168, -0.000000097288088837, 0.00000052026370052, -0.0000010837667132, 0.0000020148031524, -0.0000019754458963, 0.0000010869804328, -0.00000017247583507, -0.000000097077092574, 0.00000026078420536, 0.00000015394027112, -0.00000007654528985, -0.000000047759111721, 0.00000046758173673, -0.00000022256783521, 0.00000012268960413, 0.00000033180941871, -0.00000024992727897, 0.00000066789969716, -0.00000042167150969, 0.000000018786341595, 0.0000013465261433, -0.0000014048909148, 0.000001273037516, -0.00000068725914933, 0.0000014759990813, -0.0000012167371758, 0.0000013909496218, -0.0000013470613114, 0.0000049972956238, -0.000015642121184, 0.000014571189111, -0.0000036426352602, 0.00000099935192973, -0.00000035477245873, 0.0000014197379052, -0.000001324179162, 0.0000018769787429, -0.0000011837358097, 0.00000085796449589, 0.00000075187782613, -0.00000086547580042, 0.0000017100253756, -0.00000097462570182, 0.0000011884774317, 0.00000022071597487, -0.000000071341331217, 0.00000106464935, -0.00000018725606875, 0.00000068437492499, 0.0000004497563688, 0.00000051659959979, 0.00000048384523204, 0.00000054801947205, 0.00000032407687976, 0.0000011556730089, 0.000000053231084632, 0.00000063140265257, 0.0000014211583051, -0.00000031603587294, 0.0000018429851867,-0.000000055904873708, 0.0000013806343082, 0.00000053336764105, 0.0000014858951276, 0.00000052305184846, 0.0000014218974786, 0.00000078935823727, 0.0000014206695724, 0.0000015279634732,0.0000014674765347, 0.00000060213038798, 0.0000031240019134, -0.000000098138041437, 0.0000032685502524, 0.0000010239370319, 0.00000363570162, -0.000001566743512, 0.000006631272428,0.0000030416537999, -0.0000017978876275, 0.0000061498967102, 0.0000031983007867, 0.0000030569001429, 0.0000045740986417, 0.0000036467052904, 0.0000058390801968, 0.00000099697392242, 0.000011173024113, 0.0000033109296237, 0.0000055832573919, 0.000010356040809, 0.0000079925793729, 0.0000046736416997, 0.000017312853828, 0.0000050749429867, 0.000017387374225,0.000011375560114, 0.00001911038532, 0.000019182898606, 0.000012158020254, 0.000038185020377, 0.00001710189824, 0.000038407386665, 0.000032268555102, 0.000047518392928, 0.000047657873187, 0.000059850114323, 0.000083941669519, 0.0000703832076, 0.00012652550008, 0.000067514792077, 0.00039241533161, -0.00065917611853, 0.0034402891425, -0.011477980451, 0.024388632663, -0.023357550202, 0.012564568143, -0.0020097223696, 0.0024643213358, 0.0022304370265, 0.0041539305584, 0.00582984074, 0.014996706482, 0.013163333333, 0.013163333333];
	
	bhft = [996.79514944,1019.8715172,1013.7187816,1015.2533562,1015.2677936,1013.6754693,1020.0303292,1026.2032139,1025.1568152,1023.1695253,1032.1650835,1028.1701405,1035.1543543,1041.2124423,1039.9958764,1038.8040521,1044.7879151,1052.0442874,1047.0349353,1059.8159714,1073.7011793,1065.3793115,1084.7815746,1075.4943902,1093.2408646,1121.5421516,1110.5905292,1126.0957316,1135.0265446,1143.7980902,1159.7810947,1177.0775309,1181.9087818,1205.2873421,1226.9418499,1236.9452582,1265.2771172,1291.9462731,1306.9377903,1340.3025657,1371.8519468,1392.2896469,1428.9894654,1471.7524914,1504.000569,1542.2452327,1597.0185003,1639.680766,1684.2584356,1763.2854916,1762.5995978,1746.316117,1812.1359342,1865.140146,1917.3034816,1985.6459276,2050.1128079,2113.9028406,2184.2758296,2258.9938411,2339.7488062,2422.0109343,2522.2074567,2609.1592389,2701.1555877,2816.2184102,2923.9707714,3037.898504,3164.4352124,3294.3606465,3428.1222018,3573.1505465,3729.2756123,3889.7470042,4051.7363707,4233.307513,4425.0335773,4616.5581779,4828.733711,5048.5069782,5277.2383763,5522.5395167,5782.6035568,6057.0462562,6349.2114185,6646.1080697,6966.3563026,7308.4667199,7659.7768178,8042.4260088,8440.5191471,8865.4974029,9317.4912415,9784.5376312,10284.358234,10818.029433,11393.524033,11977.874436,12604.978225,13322.212665,14026.171116,14783.102873,15611.417394,16491.227552,17423.672397,18424.082861,19519.996159,20645.932501,21886.273836,23238.972156,24657.837539,26209.677686,27913.451716,29716.515452,31690.486478,33841.538636,36193.358979,38765.025448,41576.539227,44708.817643,48088.190201,51868.421553,56138.123585,60659.084105,66445.539995,70368.755913,78649.436351,87653.498682,94296.568922,104860.22563,116142.52856,129539.66014,145278.8309,163845.01627,186221.10403,213270.56762,246406.62549,287872.93041,340241.65287,408500.4581,498116.51473,623963.48298,790139.55335,1052948.3036,1490187.2321,2112242.7679];
	chft = [16.538183895,6.5381838952,12.690919476,14.225494008,14.211056556,12.618732215,6.2638723046,12.436757003,13.483155709,11.495865831,2.5003076144,1.494635373,8.4788491065,2.4207610529,1.2041951052,2.3960193678,8.379882366,1.1235100964,3.8858419806,16.666878019,2.7816700943,5.5401976414,24.94246066,34.229644998,51.976119333,23.674832334,12.723210002,2.7819923273,6.1488206893,2.6227249154,13.360279649,3.9361564882,0.89509439812,22.483465919,0.82895807547,10.832366383,17.499492545,9.1696634362,5.8218537098,27.542921725,4.0064593913,16.43124071,20.268577768,22.494448217,9.7536293638,28.491034328,26.282233325,16.380032371,28.19763719,50.829418869,51.515312667,35.2318318,30.587985467,22.41622633,29.747109212,38.595336822,25.871543499,37.918489181,32.454499778,42.263511708,38.491453391,43.770674728,56.425847695,30.525934491,61.470414341,53.592408144,54.159953081,59.767779532,66.768928791,63.156505304,70.605049993,74.423294723,81.701771115,78.769620817,83.219745618,98.351396712,93.374667535,98.149933147,114.02559988,105.74766735,122.98373073,122.31740975,137.74663028,136.69606912,155.46909323,141.42755796,178.82067491,163.28974238,188.02035556,194.62883537,203.46430296,221.5139528,230.47988585,236.56650381,263.25409891,270.41710055,305.07749888,279.27290394,347.83088536,369.40355463,334.55489611,422.37686094,405.93766013,473.87249854,458.57234571,541.8381186,554.07517987,571.86116191,668.48017249,684.21814813,734.64723499,817.19291192,886.58111735,916.48261868,1057.4884079,1093.5637496,1258.2565936,1313.4098759,1498.1039027,1634.1745131,1745.1980448,2035.0333077,2234.6687243,2286.291795,3500.1640957,423.05182211,7857.6286158,1146.4337146,5496.6365259,5067.0201817,6215.2827471,7181.8488298,8557.3219337,10008.863436,12367.224324,14682.239268,18453.818606,23012.48631,29356.236155,38902.569072,50713.487559,75133.480692,91042.589674,171766.16061,265472.76788,356582.76788];
	dhft = [3.3333333333,6.4097011236,8.9721378279,9.4788501879,8.9432629236,6.2942015066,6.2335431026,8.6399709039,8.3263405131,4.6653911484,0.33522408047,3.3244948265,3.6332033865,1.2083187194,1.200071491,3.5919672446,3.1677974875,0.92077729474,6.8509066664,6.482849371,0.91950918235,10.1608861,19.724035219,28.735254777,25.216983889,12.132680778,3.3137392248,1.1222761207,1.175365258,3.5791849112,3.141374387,1.0136873634,7.1961238404,7.7708079983,3.8871081527,2.2223753876,2.776609703,1.1159365755,7.240356005,7.8454874445,4.1415937729,1.2791123527,0.74195681626,4.2469396177,6.2458016546,0.73626700082,3.3007336513,3.9392016062,7.5439272265,34.114910512,28.915714822,1.5479487775,2.7239197124,2.4436276273,2.9494092034,4.241264441,4.0156485605,1.8213298009,3.2696706433,1.2573527723,1.7597404459,4.2183909889,8.6333044014,10.314826617,2.6260020655,0.18918164546,1.8692754837,2.3337164197,1.2041411624,2.4828482298,1.2727482432,2.4261587974,0.97738343278,1.4833749337,5.0438836979,1.6589097255,1.591755204,5.2918889095,2.759310842,5.7453544586,0.22210699253,5.1430735115,0.35018705337,6.257674702,4.6805117546,12.464372316,5.1769775109,8.2435377271,2.2028266026,2.9451558626,6.0165499469,2.9886443497,2.0288726544,8.8958650326,2.387667215,11.553466107,8.6015316447,22.852660471,7.1908897595,11.616219509,29.273988278,5.4797336036,22.644946136,5.1000509415,27.75525763,4.0790204228,5.9286606793,32.20633686,5.2459918801,16.809695619,27.515225642,23.129401812,9.9671671098,47.001929749,12.025113896,54.897614669,18.38442743,61.564675611,45.356870124,37.007843891,96.61175431,66.545138867,17.207690222,404.62410025,1025.7040912,2478.1922646,2237.0649671,1450.0676038,143.20544806,382.75418846,322.18869423,458.49103462,483.84716729,786.12029624,771.67164777,1257.1931127,1519.5559014,2114.5832816,3182.1109723,3936.9728292,8139.9977108,5303.0363275,26907.856979,31235.535755, 30370, 30370];

		 
		 //   определение положения точки (tvout,fiout)     
//*********  d1   := seval(146,tvout,t,d,bdft,cdft,ddft); *************
			x_spl = t    ;
            y_spl = d    ;
            b_spl = bdft ;
            c_spl = cdft ;
            d_spl = ddft ; 
	
  d1  = seval2(146,tvin,x_spl,y_spl,b_spl,c_spl,d_spl) ;

//  dout := 0.622*fiout*d1/(0.622+d1-fiout*d1);
dout = 0.622 * fiin * d1 / ((0.622+d1)*P / 101300 - fiin * d1) ;
        if (fiin> 1.0)
		{
			
		//   точка находится в области ледяного тумана    
//*********  h1   := seval(146,tvout,t,h,bhft,chft,dhft); *************
		  x_spl = t   ;
          y_spl = h    ;
          b_spl = bhft ;
          c_spl = chft ;
          d_spl = dhft ; 
			
h1   = seval2(146,tvin,x_spl,y_spl,b_spl,c_spl,d_spl) ;
		

			if (tvin>= 0.0) 
			{
			//   точка находится в области водяного тумана    
				hout = h1+4190.0*(dout-d1);
			}
			else
			{
				hout = h1+(2050.0*tvin-333400.0)*(dout-d1);
			};
			
		}
		else
		{	
			//   точка находится над (на) пограничной кривой  
			hout = 1006.0* tvin + dout* (1860.0* tvin+ 2500000.0);
			
		};
  
   var i=[];
   i[0]=hout;
   i[1]=dout;
   return i;
}

function seval2(n,u,x_spl,y_spl,b_spl,c_spl,d_spl)
{
		var j, k, dx;
		var i = 1; 
   if (i >= n) 			//then    i := 1
   { 
   i= 1;  
   };
   if (u <  x_spl[i])    //then  goto L10
		{
			i  = 1    ;
			j  = n+1  ;
	   };
   if (u <= x_spl[i+1])  //then  goto L30
   {
   dx = u - x_spl[i];
   };  
 //goto L10
		i  = 1    ;
		j  = n+1  ;
 //goto L20
	while(j >  (i+1)){
	k  = Math.round((i+j)/2);
 
  if (u <  x_spl[k])  { j = k;  };
  if(u==95){j = k;};
  if (u >= x_spl[k])     { i = k;};
  };
  dx = u - x_spl[i];
  var y=(y_spl[i] + dx * (b_spl[i]+ dx * (c_spl[i]+ dx* d_spl[i])));
  return y;
}

document.getElementById("formula1").addEventListener("change", function () {
	if(document.getElementById('formula1').value=="Отн. влажность"){
	document.getElementById('gran1').innerHTML=" %";
	}
	else if(document.getElementById('formula1').value=="Энтальпия"){
	document.getElementById('gran1').innerHTML=" кДж/кг";
	}
	else if(document.getElementById('formula1').value=="Температура"){
	document.getElementById('gran1').innerHTML=" °C";
	}
		
});

document.getElementById("formula2").addEventListener("change", function () {
	if(document.getElementById('formula2').value=="Отн. влажность"){
	document.getElementById('gran2').innerHTML=" %";
	}
	else if(document.getElementById('formula2').value=="Энтальпия"){
	document.getElementById('gran2').innerHTML=" кДж/кг";
	}
	else if(document.getElementById('formula2').value=="Температура"){
	document.getElementById('gran2').innerHTML=" °C";
	}
		
});

document.getElementById("formula2").addEventListener("change", function () {
	if(document.getElementById('formula2').value=="Отн. влажность"){
	document.getElementById('gran22').innerHTML="Ограничение [0;100]";
	}
	else if(document.getElementById('formula2').value=="Энтальпия"){
	document.getElementById('gran22').innerHTML="Ограничение [-50.24;9196.160]";
	}
	else if(document.getElementById('formula2').value=="Температура"){
	document.getElementById('gran22').innerHTML="Ограничение [-50;95]";
	}
		
});
document.getElementById("formula1").addEventListener("change", function () {
	if(document.getElementById('formula1').value=="Отн. влажность"){
	document.getElementById('gran11').innerHTML="Ограничение [0;100]";
	}
	else if(document.getElementById('formula1').value=="Энтальпия"){
	document.getElementById('gran11').innerHTML="Ограничение [-50.24;9196.160]";
	}
	else if(document.getElementById('formula1').value=="Температура"){
	document.getElementById('gran11').innerHTML="Ограничение [-50;95]";
	}
		
});

function limitchange(min,max) {
	if(document.getElementById('formula2').value=="Энтальпия"){
		//alert("Ограничение ["+min.toFixed(3)+","+max.toFixed(3)+"]");
	document.getElementById('gran22').innerHTML="Рабочие пределы ["+min.toFixed(3)+","+max.toFixed(3)+"]";
	}
	if(document.getElementById('formula1').value=="Энтальпия"){
		//alert();
	document.getElementById('gran11').innerHTML="Рабочие пределы ["+min.toFixed(3)+","+max.toFixed(3)+"]";
	}
	return true;
}



